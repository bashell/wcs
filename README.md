# wcs
单词纠错系统（Word Correction System）

简介：wcs收到输入单词后，向客户端返回一个与之最相近的单词。

### 基本原理
字符串的编辑距离可以用来表示字符串之间的相似度。如果一个单词拼写错误，那么可以根据编辑距离去wcs中寻找与输入相似度最高的单词。

### 模块划分
- **配置模块**
	- 采用单例模式读取配置文件。
- **预处理模块**
	- 根据中英文语料建立词库，形式为：`单词 词频`。
	- 中文分词使用“结巴”（cppjieba）。
	- 中文编辑距离处理：将UTF8编码的汉字转为uint32_t型数组，然后对数组求编辑距离。
- **网络框架**
	- `rptp网络库`：封装了 ThreadPool 和 I/O mutiplexing。
	- 整体思路：把TcpServer与ThreadPool结合，用户在回调函数中，把计算任务（查询服务）和数据回发的任务封装成函数，交给线程池去处理。TcpServer所在的IO线程主要处理数据收发，线程池内的线程主要处理计算任务。
- **缓存模块**
	- 缓存池，内部封装多个cache。
	- 线程每次查询前都必须向缓存池申请一个可用的cache，查询完毕后归还。
	- 缓存池维持一个全局cache，归还cache的操作即将全局cache的副本加入到缓存池中。
	- 与全局cache相关的还有一个定时器线程，每隔一段时间就会把全局cache的内容写回磁盘。

- **索引模块**
	- 为词库中的每个字（中文字或者英文字母）建立索引，根据输入的单词可得到索引范围，有效地减少了编辑距离的计算次数。
- **查询模块**
	- 若输入单词在词库中找到，则直接返回。
	- 若输入单词未在词库中找到，则计算最可能的结果：根据输入查索引表，得出索引范围，将索引范围内符合条件的单词加入到优先级队列中，返回优先级最高的单词。
- **日志模块**
	- producer-consumer模型。日志存于一个同步队列中，有一个线程专门负责向log文件写日志。
- **工具模块**
	- 封装文件I/O操作，编辑距离计算，string修剪。

### 使用方法
1. 程序主目录下执行`make submake`
2. 进入dict文件夹执行makeDict
3. 退回主目录下执行`make`
4. 进入bin文件夹后，运行server
